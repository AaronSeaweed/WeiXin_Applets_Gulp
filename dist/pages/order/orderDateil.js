"use strict";var app=getApp();Page({data:{orderid:"",orderdateil:[],goodsimg:[],goodcount:0},onLoad:function(t){wx.showLoading({title:"加载中"}),this.setData({orderid:t.orderid})},onReady:function(){},onShow:function(){var r=this;wx.request({url:app.globalData.httpHost+"/weixin/getOrderDateil",method:"POST",data:{orderid:r.data.orderid},success:function(t){if(200==t.data.status&&"success"==t.data.message){var o=!0,a=!1,e=void 0;try{for(var d,n=t.data.data[r.data.orderid].food[Symbol.iterator]();!(o=(d=n.next()).done);o=!0){var i=d.value;r.data.goodcount+=i.count,r.data.goodsimg.push(i.img)}}catch(t){a=!0,e=t}finally{try{!o&&n.return&&n.return()}finally{if(a)throw e}}wx.setStorageSync("orderinfo",t.data.data[r.data.orderid].food),r.setData({orderdateil:t.data.data[r.data.orderid],goodcount:r.data.goodcount,goodsimg:r.data.goodsimg}),wx.hideLoading()}else 500==t.data.code&&r.setData({orderdateil:[]})}})},onHide:function(){this.setData({goodcount:0})},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){},cancelorder:function(){var t=this;wx.showActionSheet({itemList:["不想要了","购买重复","无法签收","其他"],success:function(){wx.request({url:app.globalData.httpHost+"/weixin/cancelorder",method:"POST",data:{orderid:t.data.orderid},success:function(t){200==t.data.status&&"success"==t.data.message?wx.showToast({title:"操作成功",icon:"none",duration:2e3,success:function(){setTimeout(function(){wx.navigateBack({delta:1})},2e3)}}):500==t.data.code&&wx.showToast({title:"操作失败,请稍后重试",icon:"none",duration:2e3})}})},fail:function(t){console.log(t.errMsg)}})}});